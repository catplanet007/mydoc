
`mpstat` 是 Linux 系统下的一个用于监控 CPU 使用情况的工具，属于 sysstat 包的一部分。它可以显示各个 CPU 核心的使用率，以及不同模式下 CPU 的使用情况（用户模式、系统模式、空闲时间等）。

### 使用举例

#### 显示开机以来所有 CPU 的平均使用情况

```shell
mpstat
```

#### 显示开机以来每个 CPU 核的使用情况

```shell
mpstat -P ALL
```

#### 每隔 2 秒时间刷新一次，显示这 2 秒内的 CPU 使用情况

```shell
mpstat 2
```

#### 每隔 2 秒时间刷新一次，显示这 2 秒内的 CPU 使用情况，刷新 5 次

```shell
mpstat 2 5
```

#### 查看第 0 个核的使用情况
```shell
mpstat -P 0
```

#### 每隔 5 秒查看所有 CPU 核使用情况
```shell
$ $ mpstat -P ALL 5 1
Linux 5.15.0-107-generic (iZ2ze5ybozvutjqtoe2zk3Z)      09/23/2024      _x86_64_        (2 CPU)

01:41:27 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
01:41:32 PM  all    0.50    0.00    0.50    0.00    0.00    0.00    0.00    0.00    0.00   98.99
01:41:32 PM    0    0.60    0.00    0.60    0.00    0.00    0.00    0.00    0.00    0.00   98.79
01:41:32 PM    1    0.40    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.20

Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
Average:     all    0.50    0.00    0.50    0.00    0.00    0.00    0.00    0.00    0.00   98.99
Average:       0    0.60    0.00    0.60    0.00    0.00    0.00    0.00    0.00    0.00   98.79
Average:       1    0.40    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.20
```

### 输出解释

*   **%usr**：用户态下运行的 CPU 时间百分比。
*   **%nice**：以低优先级运行的用户进程所消耗的 CPU 时间百分比。
    * `nice` 是一个 Linux/Unix 系统中用于调整进程优先级的值。
    * 当一个进程的 `nice` 值较高 时，表示该进程的 优先级较低，意味着系统会在 CPU 资源紧张时，优先调度其他优先级较高的进程。
    * 反之，当 `nice` 值较低时，进程的优先级较高，它能更快获取 CPU 资源。
    * **%nice** 显示的是那些 使用了 `nice` 值 来降低优先级的进程所消耗的 CPU 资源的百分比
*   **%sys**：系统态（内核）消耗的 CPU 时间百分比。不包括处理硬件和软件中断所用的时间。
*   **%iowait**：CPU 空闲时等待 I/O 操作完成的时间百分比。
*   **%irq**：硬件中断处理时间。
*   **%soft**：软中断处理时间。
*   **%steal**：被虚拟化平台“窃取”的 CPU 时间。
*   **%guest**：运行虚拟 CPU 的时间。
*   **%idle**：CPU 空闲时间百分比。


